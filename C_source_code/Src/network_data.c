
/**
  ******************************************************************************
  * @file    network_data.c
  * @author  AST Embedded Analytics Research Platform
  * @date    Fri Sep 30 23:48:49 2022
  * @brief   AI Tool Automatic Code Generator for Embedded NN computing
  ******************************************************************************
  * @attention
  *
  * Copyright (c) 2021 STMicroelectronics.
  * All rights reserved.
  *
  * This software is licensed under terms that can be found in the LICENSE file
  * in the root directory of this software component.
  * If no LICENSE file comes with this software, it is provided AS-IS.
  ******************************************************************************
  */
#include "network_data.h"
#include "ai_platform_interface.h"

AI_API_DECLARE_BEGIN

AI_ALIGNED(32)
const ai_u64 s_network_network_weights_array_u64[ 230 ] = {
  0xbee915cf40e6e0b1U, 0xbf1137f8be08c199U, 0x3d784ff83f91ed51U, 0xbe9e35a0bf0bab44U,
  0xbe86a530be8c625cU, 0xbef8f574bed85e4cU, 0xbe580630bed409afU, 0x3f70e835bebfd8f1U,
  0xbf18549cbc843f86U, 0xbd8e0e49be95eb65U, 0xbe945f37be238b46U, 0xbdc3fb3ebd2bc3f1U,
  0xbe853d89be37127fU, 0x3e535d4ebde5991fU, 0x3f93eca1befe057aU, 0xbf40698ebe639a42U,
  0x3e2acb42be59f9c6U, 0x3f7c1feabe59f3adU, 0x3fc0c252be0ca847U, 0x3f3fd48b3f9de7c3U,
  0x3f98a1f7bfadb010U, 0xbfaf84313fae9aa0U, 0xbff441303fe1e840U, 0x3f866c523fdae1dbU,
  0x4016aeedbfb774beU, 0x3e1b26423ed8dfffU, 0x3e2b92433edaf060U, 0x400a19783decc0c5U,
  0xbd7c084cbe936082U, 0x3ed68ddf3f62d9feU, 0xbdcbca113f8c6a41U, 0xbd669d0c3dfac5dbU,
  0x3ee97f7e3e5e3e04U, 0x3e5dcc3cbef89b0bU, 0x3ebfeac9c052d6e9U, 0xbe825260bf03cbeaU,
  0xbf20d89abe0fb224U, 0xbfcc1502be471e62U, 0x3e7f1d9c3e2deac3U, 0x3e5e2979bfc460ecU,
  0xbee2c8543df4810bU, 0x3f0f6972c01db0e4U, 0x3fd8f3c0c023db32U, 0xc0362f81bffde9afU,
  0xc02283b2bf0875f1U, 0xbf945d5140082edaU, 0x3f64f6a8c0266482U, 0x3fe59e6ebff94297U,
  0xbe0c31bebd9f944cU, 0xbe269b9f4001aca6U, 0xbdc3c1343f3ef134U, 0x402c32c1bfa7cbb7U,
  0xbed329fdbffca2f3U, 0xbcc80eb5bc5fff38U, 0xbe2ff1e640232875U, 0xbe825981bf4b2d24U,
  0x401d25a93d2624caU, 0x3efd88793e04b4c8U, 0xbf7e5268bf7417efU, 0xbf756b91c002eef2U,
  0x3f223f53be3b2efcU, 0xc092aec93f899c07U, 0xbfb569fc3f7cf405U, 0xbf3664df3e3b540dU,
  0xbef6219e3f260d61U, 0xbebbab113eb773f7U, 0x3f73303c3dec012aU, 0x3f81a9d6bfa46c3fU,
  0xbfb8f786be1549a5U, 0x3f4a4faa3ecfb025U, 0x3f994d133ecae065U, 0xc01b63323fa77f14U,
  0xbf8717403f846ddcU, 0x3fcd4a713f8a2588U, 0x40064df93d2d5543U, 0x3f38cd0ebfc44624U,
  0x3f5823bfc0161822U, 0x3f90db48c00e8604U, 0xbe9fdbcdbe8fcfacU, 0xbea5a7ffc0bef332U,
  0xbf3f4c033ee17e68U, 0xc08e45a0beb3a79dU, 0xc01ebd24bf08422eU, 0x3db4e8c4bf0afd3eU,
  0xbf50661a4036559dU, 0x3d5ec06ac02613bfU, 0x4095d6193e168d9aU, 0xbfa7b0f4be07f3bbU,
  0x3eaa71fc3ead648aU, 0x3f0afb804080c3f7U, 0x3f117ed2bf7b2efaU, 0x401d78983e29e12fU,
  0xbe976f9a3f139d4aU, 0xbf2e48c83b43af60U, 0xbf65a7863fae24a9U, 0x4086b93fbf7f34a6U,
  0xbdddba13be99be52U, 0xbf0208e93dceca56U, 0xbd5941d0be2ae409U, 0xbe0bd3f4be1f42ddU,
  0x3e382899bec0ea72U, 0xbecb45a43eba2e07U, 0x3d02bcad3daff077U, 0xbd98c2da3f429d8aU,
  0xbf86c8973ef0adbeU, 0xbd990d1abd1ace9dU, 0x3d2ce65b3e0076a8U, 0xbfa8df47bf8639d1U,
  0xbf82c82fbe89349aU, 0xbf0836933eb0a939U, 0x3d1d8698c010fcd0U, 0xbf0beb16bf7fdf7fU,
  0xbeb4e4ed3e31d940U, 0xbf3bae56bfa5c854U, 0x3ef449083efb2d81U, 0x3fb1f0a0bf03d9a2U,
  0x3eab9969bec88420U, 0xbe119b1bbe514f35U, 0x3e70dc0a3f0adda7U, 0xbeac6d87bea61b5bU,
  0x3ef07b4abf27b188U, 0xbed639ecbf0f4c6eU, 0x3e84e5b9bc429e76U, 0x3dfbe21d3f32dd3aU,
  0xbfb373f3bf0d9602U, 0x3f1a9fa03f073c92U, 0xbd2fd9a43ef064a9U, 0xbe7729173f02ab72U,
  0x3de08391bf8e712dU, 0x3f284cf13f1c6438U, 0xbdc4c6103dca279cU, 0xbf11237d3e5cb7ebU,
  0x3e6845d3bf03d63cU, 0xbeaec472bfa4ad5bU, 0x3e6e2c1ebe0a7a13U, 0x3e23db9f3f2113dfU,
  0xbee9dddbbdb5b87dU, 0x3e8cfef43f001db6U, 0xbe829d87bf71a6acU, 0x3f863c813e850427U,
  0x3e9ceb563cbd6f43U, 0xbfe8674d3e3fa467U, 0xbe8308fb3e9e3d84U, 0xbd2f5fb73e435558U,
  0x3efb77583ecf82cbU, 0x3ef826023e4d9cdaU, 0xc00afa383f1201e8U, 0x3d7866d7be944aaeU,
  0xbe27785e3ea00df6U, 0xbf3390ce3ee093caU, 0x3e43ab993dce790dU, 0xbf8786ae3e2d41a9U,
  0xbcc4cc493d1c5372U, 0xbdd87b55bd27d12cU, 0x3ce85b05bef7e164U, 0x3eb9ad93be64390cU,
  0x3ec0e00bbebdff6fU, 0xbf2369a4bf9a48d5U, 0xbf14a9373f5cc159U, 0xbe423f0e3e338c5cU,
  0xbf8a1c97be66654bU, 0xbf3bd36c3e2a8972U, 0xbf442091bd849520U, 0xbef4a9103e68e815U,
  0xbd8138b3bf023587U, 0x3f7a1582bd2381f4U, 0x3db7c3a23ddf882cU, 0x3e9fb567bfaf60fdU,
  0x3da57ad73f0956ddU, 0xbed21bfb3e9810cbU, 0xbeae1661bdf1ba67U, 0x3fb3c1db3f92af34U,
  0x409b237bbf4dd9e3U, 0x3feb25d73f81f862U, 0x3ebeb2fd3f077d6aU, 0x3f78895d3f0e79e1U,
  0xbf01ed76be0c8185U, 0xbe20090dbeed5a43U, 0xbdf28688be180b51U, 0x3e5485e43d910caeU,
  0x3e9ad6783ea45bfbU, 0x3eaedf97be3c9167U, 0x3ecaa0273e93865fU, 0xbe72855a3ea06ff1U,
  0x3e1e91673ea6e730U, 0x3e870c5f3e8bad77U, 0x3e6068f6beb82bacU, 0x3ec3ad0b3e8ac9c4U,
  0xbe80108e3ea7f8caU, 0x3e74aa6a3e582f4fU, 0x3eb1804c3ebad334U, 0x3e883c8bbe313554U,
  0x3e936d7f3e3040adU, 0xbea850413eb41149U, 0x3e6444b43e52feaeU, 0x3e90710a3eab3224U,
  0x3e338d5ebec51e75U, 0x3ecd6b503e710628U, 0xbe8909ee3eb160c2U, 0x3e98a1e23e32570aU,
  0x3e81facb3ed4a9e8U, 0x3e3339c2bec5360dU, 0x3e8c6a623ebb4c4fU, 0xbe1e33303e7c5379U,
  0xbe14bdf93e40d858U, 0xbe0c0638bea51102U, 0xbe3eedd83e9e493bU, 0xbe8bcea9be326ea7U,
  0x3e9565f6be86966cU, 0xbe6defb6be44627aU, 0xbe44d7e2bea518daU, 0xbe8d61b83e3f1756U,
  0xbe6d0d15be391b14U, 0x3e850ad1be8e0c09U, 0xbe2c9da7beaa670bU, 0xbe7d8cc1be8db363U,
  0xbe65399b3eabbc8fU, 0xbef99990be7f51ddU, 0x3e8b7921bed124f9U, 0xbe6aa172be662a2dU,
  0xbec96684beee9449U, 0xbe8800793ea617f9U, 0xbe85a1bcbea3a1e1U, 0x3e921e8ebe8833c6U,
  0xbeae35e2beae4c37U, 0xbe7eec51bea8b860U, 0xbe8fefd63ea78cfeU, 0xbec2278fbe975916U,
  0x3e6a69d4be2acc3bU, 0xbe552f35U,
};


ai_buffer g_network_data_map_activations[AI_NETWORK_DATA_ACTIVATIONS_COUNT] = {
  AI_BUFFER_INIT(AI_FLAG_NONE,  AI_BUFFER_FORMAT_U8,
    AI_BUFFER_SHAPE_INIT(AI_SHAPE_BCWH, 4, 1, 2156, 1, 1),
    2156, NULL, NULL),    /* heap_overlay_pool */
  };
ai_buffer g_network_data_map_weights[AI_NETWORK_DATA_WEIGHTS_COUNT] = {
  AI_BUFFER_INIT(AI_FLAG_NONE,  AI_BUFFER_FORMAT_U8,
    AI_BUFFER_SHAPE_INIT(AI_SHAPE_BCWH, 4, 1, 1836, 1, 1),
    1836, NULL, s_network_network_weights_array_u64),   /* network_weights_array */
  };


/*!
 * @brief Get network activations buffer initialized struct.
 * @ingroup network_data
 * @param[in] ptr a pointer to the activations array storage area
 * @return an ai_buffer initialized struct
 */
AI_DEPRECATED
AI_API_ENTRY
ai_buffer ai_network_data_activations_buffer_get(const ai_handle ptr)
{
  ai_buffer buf = AI_BUFFER_INIT(
    AI_FLAG_NONE, AI_BUFFER_FORMAT_U8,
    AI_BUFFER_SHAPE_INIT(AI_SHAPE_BCWH, 4, 1, AI_NETWORK_DATA_ACTIVATIONS_SIZE, 1, AI_NETWORK_DATA_ACTIVATIONS_COUNT),
    AI_NETWORK_DATA_ACTIVATIONS_SIZE,
    NULL, ptr);
  return buf;
}

/*!
 * @brief Get network weights buffer initialized struct.
 * @ingroup network_data
 * @param[in] ptr a pointer to the weights array storage area
 * @return an ai_buffer initialized struct
 */
AI_DEPRECATED
AI_API_ENTRY
ai_buffer ai_network_data_weights_buffer_get(const ai_handle ptr)
{
  ai_buffer buf = AI_BUFFER_INIT(
    AI_FLAG_NONE, AI_BUFFER_FORMAT_U8|AI_BUFFER_FMT_FLAG_CONST,
    AI_BUFFER_SHAPE_INIT(AI_SHAPE_BCWH, 4, 1, AI_NETWORK_DATA_WEIGHTS_SIZE, 1, AI_NETWORK_DATA_WEIGHTS_COUNT),
    AI_NETWORK_DATA_WEIGHTS_SIZE,
    NULL, ptr);
  return buf;
}


/*!
 * @brief Get network weights array pointer as a handle ptr.
 * @ingroup network_data
 * @return a ai_handle pointer to the weights array
 */
AI_DEPRECATED
AI_API_ENTRY
ai_handle ai_network_data_weights_get(void)
{
  static const ai_u8* const s_network_weights_table[1 + 2] = {
    AI_PTR(AI_MAGIC_MARKER),
    AI_PTR(s_network_network_weights_array_u64),
    AI_PTR(AI_MAGIC_MARKER)
  };

  return AI_HANDLE_PTR(s_network_weights_table);

}


/*!
 * @brief Get network params configuration data structure.
 * @ingroup network_data
 * @return true if a valid configuration is present, false otherwise
 */
AI_API_ENTRY
ai_bool ai_network_data_params_get(ai_network_params* params)
{
  if (!params) return false;
  
  const ai_buffer_array map_activations = 
    AI_BUFFER_ARRAY_OBJ_INIT(AI_FLAG_NONE, AI_NETWORK_DATA_ACTIVATIONS_COUNT, g_network_data_map_activations);
  
  const ai_buffer_array map_weights = 
    AI_BUFFER_ARRAY_OBJ_INIT(AI_FLAG_NONE, AI_NETWORK_DATA_WEIGHTS_COUNT, g_network_data_map_weights);

  return ai_platform_bind_network_params(params, &map_weights, &map_activations);
}


AI_API_DECLARE_END
